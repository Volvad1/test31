(()=>{"use strict";var t={370:t=>{t.exports=function(t,e){return e||(e={}),t?(t=String(t.__esModule?t.default:t),e.hash&&(t+=e.hash),e.maybeNeedQuotes&&/[\t\n\f\r "'=<>`]/.test(t)?'"'.concat(t,'"'):t):t}},347:(t,e,s)=>{t.exports=s.p+"images/arrow..png"},421:(t,e,s)=>{t.exports=s.p+"images/avatar..png"}},e={};function s(n){var o=e[n];if(void 0!==o)return o.exports;var a=e[n]={exports:{}};return t[n](a,a.exports,s),a.exports}s.m=t,s.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return s.d(e,{a:e}),e},s.d=(t,e)=>{for(var n in e)s.o(e,n)&&!s.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),s.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{var t;s.g.importScripts&&(t=s.g.location+"");var e=s.g.document;if(!t&&e&&(e.currentScript&&(t=e.currentScript.src),!t)){var n=e.getElementsByTagName("script");if(n.length)for(var o=n.length-1;o>-1&&!t;)t=n[o--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),s.p=t})(),s.b=document.baseURI||self.location.href,(()=>{const t={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let e;const n=new Uint8Array(16);function o(){if(!e&&(e="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!e))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return e(n)}const a=[];for(let t=0;t<256;++t)a.push((t+256).toString(16).slice(1));function i(t,e=0){return(a[t[e+0]]+a[t[e+1]]+a[t[e+2]]+a[t[e+3]]+"-"+a[t[e+4]]+a[t[e+5]]+"-"+a[t[e+6]]+a[t[e+7]]+"-"+a[t[e+8]]+a[t[e+9]]+"-"+a[t[e+10]]+a[t[e+11]]+a[t[e+12]]+a[t[e+13]]+a[t[e+14]]+a[t[e+15]]).toLowerCase()}const r=function(e,s,n){if(t.randomUUID&&!s&&!e)return t.randomUUID();const a=(e=e||{}).random||(e.rng||o)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,s){n=n||0;for(let t=0;t<16;++t)s[n+t]=a[t];return s}return i(a)};class c{constructor(){this.id=r()}}const d=function(t){return JSON.parse(localStorage.getItem(t)||"[]")},l=function(t){let e=document.cookie.match(new RegExp("(?:^|; )"+t.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return e?decodeURIComponent(e[1]):void 0};class u extends c{constructor(t,e){super(),this.login=t,this.password=e,this.storageKey="users"}get hasAccess(){let t=d(this.storageKey);if(0==t.length)return!1;for(let e of t)if(e.login==this.login&&e.password==this.password)return!0;return!1}static save(t){try{return function(t,e){const s=d(e);s.push(t),localStorage.setItem(e,JSON.stringify(s))}(t,t.storageKey),!0}catch(t){throw new Error(t)}}}class _ extends c{constructor(t){super(t),this.id=t.id,this.tasks={backLogList:[],readyTasks:[],inProgressTasks:[],finishedTasks:[]}}get getId(){return this.id}}const m='<div class="tasks__buttons"> <button class="tasks__btn_edit" title="edit task"></button> <button class="tasks__btn_remove" title="remove task"></button> </div>';const p=function(){document.querySelector(".footer").innerHTML='<div class="footer__content"> <p class="footer__tasks-info"> <span>Active tasks: <span id="active-tasks"></span></span> <span>Finished tasks: <span id="finished-tasks"></span></span> </p> <p class="footer__author-info">Kanban board by Anatoly Kostrykin, 2023</p> </div>',function(){const t=document.querySelector(".tasks_backlog .tasks__list"),e=document.querySelector(".tasks_finished .tasks__list");let s=0,n=0;t&&e&&(t.childNodes.forEach((t=>{t.classList.contains("tasks__list-item")&&s++})),e.childNodes.forEach((t=>{t.classList.contains("tasks__list-item")&&n++})),document.querySelector("#active-tasks").textContent=s,document.querySelector("#finished-tasks").textContent=n)}()},f=function(t,e){const s=document.querySelector(".tasks_backlog .tasks__btn_submit"),n=document.querySelector(".tasks_backlog .tasks__list"),o=document.querySelector(".tasks_backlog .tasks__btn_add"),a=document.querySelector(".tasks_ready .tasks__list"),i=document.querySelector(".tasks_ready .tasks__btn_add"),r=document.querySelector(".tasks_in-progress .tasks__list"),c=document.querySelector(".tasks_in-progress .tasks__btn"),u=document.querySelector(".tasks_finished .tasks__list"),f=document.querySelector(".tasks_finished .tasks__btn"),g=new _(t);function k(t,e){let s=0;e.innerHTML="",t.forEach((t=>{const n=document.createElement("li");n.classList.add("tasks__list-item"),n.setAttribute("index",s++),n.textContent=t,""!==n.textContent&&e.append(n),n.insertAdjacentHTML("beforeend",m)}))}function b(t){const e=d("users").filter((e=>e.id!==t.id)).concat(t);localStorage.clear(),localStorage.setItem("users",JSON.stringify(e))}function h(e,a,r,c,d,l){const u=document.createElement("li");u.classList.add("tasks__list-item"),e.addEventListener("input",(()=>{u.textContent=e.value,""!==e.value&&e.addEventListener("focusout",(_=>{_.stopImmediatePropagation(),e.remove(),"add"==r?(u.setAttribute("index",`${a.childNodes.length}`),t.tasks.backLogList.push(u.textContent),n.append(u),L(o,s)):"edit"==r&&(u.setAttribute("index",`${d}`),t.tasks[l].splice(d,1,e.value),c?c.after(u):a.prepend(u)),u.insertAdjacentHTML("beforeend",m),b(t),p(),i.classList.remove("disable")}))}))}function v(t,e){t.closest(".tasks").classList.add("show"),t.innerHTML="",e.childNodes.forEach((e=>{if(e.classList.contains("tasks__list-item")){const s=e.cloneNode(!0);s.className="tasks__dropdown-item",t.append(s)}}))}function y(){document.addEventListener("click",(e=>{if(e.stopImmediatePropagation(),t=q(),e.target.closest(".dropdown")||e.target.closest(".dropdown__list")){const s=e.target.closest(".tasks"),n=s.querySelector(".tasks__list"),o=s.previousElementSibling.querySelector(".tasks__list"),a=s.querySelector(".dropdown__input");a.addEventListener("input",(()=>{s.querySelector(".dropdown__list").childNodes.forEach((t=>{t.textContent.toLowerCase().includes(a.value.toLowerCase())?t.style.display="block":t.style.display="none"}))}));const r=e.target.closest(".tasks__dropdown-item");if(r){const e=r.getAttribute("index"),a=o.querySelector(`li[index="${e}"]`);if(a){a.setAttribute("index",`${n.childNodes.length}`),n.append(a),t.tasks[o.getAttribute("id")].splice(e,1),t.tasks[n.getAttribute("id")].push(a.innerText),b(t);const i=n.lastElementChild.getBoundingClientRect().top+scrollY;n.scrollTo({top:i,behavior:"smooth"}),s.classList.remove("show"),r.remove(),s.querySelector(".tasks__btn_add").classList.add("show")}S(i,c,f),p()}}else{const t=document.querySelectorAll(".tasks.show");t&&t.forEach((t=>t.classList.remove("show")));const e=document.querySelectorAll(".tasks__btn_add");e&&e.forEach((t=>{t.closest(".tasks_backlog")||t.classList.add("show")}))}}))}function L(t,e){t.classList.add("show"),e.classList.remove("show")}function w(t,e){t.classList.remove("show"),e.classList.add("show")}function S(t,e,s){0==n.children.length?t.classList.add("disable"):t.classList.remove("disable"),0==a.children.length?e.classList.add("disable"):e.classList.remove("disable"),0==r.children.length?s.classList.add("disable"):s.classList.remove("disable")}function q(){if("admin-mode"==e){const t=JSON.parse(l("choisedUser"));return d("users").find((e=>e.id==t))}return t}Object.assign(t,t,g),function(t){const e=d("users").find((e=>e.id===t.id));e.tasks&&(t.tasks=e.tasks);b(t)}(t),k((t=q()).tasks.backLogList,n),k(t.tasks.readyTasks,a),k(t.tasks.inProgressTasks,r),k(t.tasks.finishedTasks,u),document.addEventListener("mousedown",(e=>{if(t=q(),e.target.classList.contains("tasks__list-item")){if(e.target.closest(".tasks_finished"))return;const s=e.target.closest(".tasks"),n=s.querySelector(".tasks__list"),o=s.nextElementSibling.querySelector(".tasks__list"),a=e.target;a.ondragstart=()=>!1;let r=e.clientX-a.getBoundingClientRect().left,d=e.clientY-a.getBoundingClientRect().top;function l(t,e){a.style.left=t-r+"px",a.style.top=e-d+"px"}a.style.position="absolute",a.style.zIndex=10,document.body.append(a),l(e.pageX,e.pageY);let u=null;function _(e){l(e.pageX,e.pageY),a.hidden=!0;let s=document.elementFromPoint(e.clientX,e.clientY);if(a.hidden=!1,!s)return;let r=s.closest(".tasks");u!=r&&(u&&m(u),u=r,u&&r==o.parentNode&&(u.style.backgroundColor="#92f0c9")),a.onmouseup=function(){if(document.removeEventListener("mousemove",_),a.onmouseup=null,a.style.position="relative",a.style.left=0,a.style.top=0,u&&m(u),u&&r==o.parentNode){o.append(a);const e=a.getAttribute("index");t.tasks[n.getAttribute("id")].splice(e,1),t.tasks[o.getAttribute("id")].push(a.innerText),b(t),k(t.tasks[n.getAttribute("id")],n),k(t.tasks[o.getAttribute("id")],o),S(i,c,f),p()}r!=o.parentNode&&(n.append(a),u&&m(u))}}function m(t){t.style.background=""}document.addEventListener("mousemove",_)}})),b(t),S(i,c,f),p(),o.addEventListener("click",(e=>{e.stopImmediatePropagation(),t=q();const a=document.createElement("input");!function(t){w(o,s);const e=document.querySelector(".tasks__input");e&&e.remove();t.classList.add("tasks__input"),t.setAttribute("placeholder","task description"),n.append(t);const a=n.lastElementChild.getBoundingClientRect().top+scrollY;n.scrollTo({top:a,behavior:"smooth"}),document.addEventListener("click",(e=>{e.target.closest(".tasks_backlog")||(t&&t.remove(),L(o,s))}))}(a),h(a,n,"add")})),document.addEventListener("click",(e=>{if(e.target.closest(".tasks__btn_remove")){e.stopImmediatePropagation(),t=q();const s=e.target.closest(".tasks");if(s){e.target.closest(".tasks__list-item").remove();const n=document.querySelector(`.${s.classList[1]} .tasks__list`),o=Object.entries(n.childNodes).map((t=>t[1].innerText));t.tasks[n.getAttribute("id")]=o,b(t),S(i,c,f),p()}}})),document.addEventListener("click",(e=>{if(e.target.closest(".tasks__btn_edit")){e.stopImmediatePropagation(),s(),t=q();const n=e.target.closest(".tasks__list-item"),a=+n.getAttribute("index"),i=n.previousElementSibling,r=e.target.closest(".tasks__list"),c=r.getAttribute("id"),d=r.parentNode.querySelector(".tasks__btn_add"),l=r.parentNode.querySelector(".tasks__btn_submit");n.remove();const u=document.querySelector(".tasks__input");u&&u.remove();const _=document.createElement("input");_.value=n.textContent,_.classList.add("tasks__input"),_.setAttribute("placeholder","task description"),i?i.after(_):r.prepend(_),_.addEventListener("input",(()=>{""!==_.value?(s(),o.classList.remove("disable"),w(d,l),_.addEventListener("focusout",(()=>{L(d,l);document.querySelectorAll(".tasks__btn_add, .tasks__btn_edit, .tasks__btn_remove").forEach((t=>t.classList.remove("disable")))}))):(L(d,l),o.classList.add("disable"))})),h(_,r,"edit",i,a,c)}function s(){document.querySelectorAll(".tasks__btn_add, .tasks__btn_edit, .tasks__btn_remove").forEach((t=>t.classList.add("disable")))}})),i.addEventListener("click",(e=>{e.stopImmediatePropagation(),t=q(),i.classList.remove("show");v(document.querySelector(".tasks_ready .dropdown__list"),n),y()})),c.addEventListener("click",(e=>{e.stopImmediatePropagation(),t=q(),c.classList.remove("show");v(document.querySelector(".tasks_in-progress .dropdown__list"),a),y()})),f.addEventListener("click",(e=>{e.stopImmediatePropagation(),t=q(),f.classList.remove("show");v(document.querySelector(".tasks_finished .dropdown__list"),r),y()}))},g=function(){function t(){const t=d("users"),e=document.querySelector(".admin-panel__users-list");e.innerHTML="",t&&t.length>0&&t.forEach((t=>{if("admin"!==t.login){const s=document.createElement("li");s.classList.add("admin-panel__user"),s.textContent=t.login,s.setAttribute("data-user-id",t.id),s.insertAdjacentHTML("afterbegin",'<button class="admin-panel__btn_remove" title="remove user">x</button>'),e.append(s)}}))}!function(){const e=document.querySelector(".admin-panel__btn_add");e&&e.addEventListener("click",(t=>{t.stopImmediatePropagation(),t.preventDefault(),e.classList.remove("show"),s.classList.add("show"),document.addEventListener("click",(t=>{t.target.closest(".admin-panel__form")||(e.classList.add("show"),s.classList.remove("show"))}))}));const s=document.querySelector(".admin-panel__form");s&&s.addEventListener("submit",(o=>{o.preventDefault(),function(){const t=document.querySelector(".admin-panel__message");t&&t.remove()}();const a=document.querySelector(".admin-panel__input_login"),i=document.querySelector(".admin-panel__input_password");if(""!==a.value&&""!==i.value){const o=new u(a.value,i.value),r=new _(o);Object.assign(o,o,r),u.save(o),setTimeout(n,500,s,e),t()}}));function n(t,e){const s=document.createElement("p");s.classList.add("admin-panel__message"),s.textContent="User added successfully",t.after(s),t.classList.remove("show"),e.classList.add("show"),setTimeout((()=>s.remove()),2e3)}}(),t(),document.addEventListener("click",(t=>{const e=document.querySelector(".content");if(t.target.classList.contains("admin-panel__user")){t.stopImmediatePropagation(),document.querySelectorAll(".admin-panel__user").forEach((t=>{t.classList.remove("active")})),t.target.classList.add("active"),e.classList.remove("hint"),e.classList.contains("hint")||(document.querySelector(".admin-panel__hint").style.display="none");const s=t.target.getAttribute("data-user-id");document.cookie=`choisedUser=${JSON.stringify(s)}; sameSite=lax; max-age=31536000`;const n=d("users").find((t=>t.id==s));f(n,"admin-mode")}})),document.addEventListener("click",(e=>{if(e.target.closest(".admin-panel__btn_remove")){const s=d("users"),n=e.target.closest(".admin-panel__user").getAttribute("data-user-id"),o=s.filter((t=>t.id!==n));localStorage.setItem("users",`${JSON.stringify(o)}`),t()}}))};const k='<div class="tasks-container"> <section class="tasks tasks_backlog"> <h2 class="tasks__title">Backlog</h2> <ul class="tasks__list" id="backLogList"></ul> <button class="tasks__btn tasks__btn_add show">Add card</button> <button class="tasks__btn tasks__btn_submit">Submit</button> </section> <section class="tasks tasks_ready"> <h2 class="tasks__title">Ready</h2> <ul class="tasks__list" id="readyTasks"></ul> <div class="tasks__dropdown dropdown"> <div class="dropdown__list-wrapper"> <ul class="dropdown__list"></ul> </div> <form class="dropdown__form" action="#"> <fieldset class="dropdown__border"> <legend class="dropdown__title">Add card</legend> <input class="dropdown__input" type="text" placeholder="task search..."> </fieldset> </form> </div> <button class="tasks__btn tasks__btn_add show">Add card</button> <button class="tasks__btn tasks__btn_submit">Submit</button> </section> <section class="tasks tasks_in-progress"> <h2 class="tasks__title">In progress</h2> <ul class="tasks__list" id="inProgressTasks"></ul> <div class="tasks__dropdown dropdown"> <div class="dropdown__list-wrapper"> <ul class="dropdown__list"></ul> </div> <form class="dropdown__form" action="#"> <fieldset class="dropdown__border"> <legend class="dropdown__title">Add card</legend> <input class="dropdown__input" type="text" placeholder="task search..."> </fieldset> </form> </div> <button class="tasks__btn tasks__btn_add show">Add card</button> <button class="tasks__btn tasks__btn_submit">Submit</button> </section> <section class="tasks tasks_finished"> <h2 class="tasks__title">Finished</h2> <ul class="tasks__list" id="finishedTasks"></ul> <div class="tasks__dropdown dropdown"> <div class="dropdown__list-wrapper"> <ul class="dropdown__list"></ul> </div> <form class="dropdown__form" action="#"> <fieldset class="dropdown__border"> <legend class="dropdown__title">Add card</legend> <input class="dropdown__input" type="text" placeholder="task search..."> </fieldset> </form> </div> <button class="tasks__btn tasks__btn_add show">Add card</button> <button class="tasks__btn tasks__btn_submit">Submit</button> </section> </div>';const b=document.querySelector(".content"),h=function(){document.querySelector(".header__content").innerHTML='<form class="login-form" action="#" method="post"> <input class="login-form__input" type="text" name="login" placeholder="Login"> <input class="login-form__input" type="password" name="password" placeholder="Password"> <button class="login-form__btn" type="submit">Enter</button> </form>',b.innerHTML='<section class="message"> <h2 class="message__text">Please log in to view your tasks!</h2> </section>',document.querySelector(".footer").innerHTML=""},v=function(){document.querySelector("#error-message").classList.add("show"),document.body.classList.add("lock")},y=function(){const t=document.querySelector(".popup.show");if(t){const e=document.querySelector(".error-message__link");e&&e.addEventListener("click",(s=>{s.preventDefault();const n=e.getAttribute("href"),o=document.querySelector(`${n}`);o&&(o.classList.add("show"),document.body.classList.add("lock"),t.classList.remove("show"),L(o))})),L(t)}},L=function(t){document.addEventListener("keydown",(e=>{"Escape"===e.code&&(t.classList.remove("show"),document.body.classList.remove("lock"))})),document.addEventListener("click",(e=>{!e.target.closest(".btn-close")&&e.target.closest(".popup__body")||(t.classList.remove("show"),document.body.classList.remove("lock"))}))},w=document.querySelector(".burger-menu");var S=s(370),q=s.n(S),E=new URL(s(421),s.b),A=new URL(s(347),s.b);const x='<div class="menu"> <div class="menu__about-user"> <div class="menu__user-avatar"> <img src="'+q()(E)+'" alt="avatar"> </div> <p class="menu__user-info">Hello, <span class="current-user-name"></span></p> <div class="menu__icon"> <img src="'+q()(A)+'" alt="arrow"> </div> </div> <nav class="menu__navigation"> <ul class="menu__list"> <li class="menu__list-item menu__user-info">Profile: <span class="current-user-name"></span></li> <li class="menu__list-item menu__user-info">ID: <span class="current-user-id"></span></li> <li class="menu__list-item"> <a class="menu__logout" href="#">Log Out</a> </li> </ul> </nav> </div>',T=function(){const t=document.querySelector(".menu");t.classList.toggle("active"),document.addEventListener("click",(e=>{e.target.closest(".menu")||t.classList.remove("active")}))},I=function(t,e){document.querySelector(".header__content").innerHTML=x,function(t,e){document.querySelectorAll(".current-user-name").forEach((e=>{e.textContent=t}));const s=document.querySelector(".current-user-id");s.setAttribute("title",`"${e}"`),s.textContent=e.slice(0,18)+"..."}(t,e);const s=document.querySelector(".menu__about-user");s&&s.addEventListener("click",T);const n=document.querySelector(".menu__logout");n&&n.addEventListener("click",(t=>{t.preventDefault(),document.cookie='currentUser=""; max-age=-1; samesite=lax',h(),location.reload()}))};function N(){if(!!!document.cookie.includes("currentUser"))return w.classList.add("show"),w.addEventListener("click",(()=>{w.classList.toggle("open"),document.querySelector(".header .login-form").classList.toggle("show")})),void h();{w.classList.remove("show");const t=function(){if(!document.cookie.includes("currentUser"))return;const t=JSON.parse(l("currentUser")).name;return d("users").find((e=>e.login==t))}();I(t.login,t.id);!!document.cookie.includes("currentUser")&&JSON.parse(l("currentUser")).isAdmin?(b.classList.add("admin-content","hint"),b.innerHTML="",b.insertAdjacentHTML("beforeend",'<div class="admin-content"> <aside class="admin-panel"> <h2 class="admin-panel__title">Admin panel</h2> <h2 class="admin-panel__title_small">All registered user:</h2> <ul class="admin-panel__users-list"></ul> <div class="admin-panel__menu"> <form class="admin-panel__form" action="#"> <fieldset class="admin-panel__form-border"> <legend class="admin-panel__form-title">Add new user</legend> <div class="admin-panel__row"> <input class="admin-panel__input admin-panel__input_login" type="text" placeholder="Введите логин"> <input class="admin-panel__input admin-panel__input_password" type="password" placeholder="Введите пароль"> </div> <button class="admin-panel__btn admin-panel__btn_confirm">Confirm</button> </fieldset> </form> <button class="admin-panel__btn admin-panel__btn_add show">Add new user</button> </div> </aside> </div>'),b.insertAdjacentHTML("beforeend",'<h2 class="admin-panel__hint">Select a user from the list to see their tasks</h2>'),b.insertAdjacentHTML("beforeend",k),g()):(b.innerHTML=k,f(t)),p()}}!function(t){const e=new t("test","qwerty123"),s=new t("admin","1234");d("users").find((t=>t.login==e.login))||(t.save(e),t.save(s))}(u),N(),document.addEventListener("submit",(t=>{if(t.target.closest(".login-form")){t.preventDefault();const e=t.target.closest(".login-form"),s=new FormData(e),n=s.get("login");!function(t,e){return!!new u(t,e).hasAccess}(n,s.get("password"))?(v(),y(),b.innerHTML='<section class="message"> <h2 class="message__text">Sorry, you don\'t have access to this resource, please log in!</h2> </section>'):(!function(t){const e={isAdmin:"admin"==t,name:t};document.cookie=`currentUser=${JSON.stringify(e)}; max-age=31536000; samesite=lax`}(n),N())}}))})()})();